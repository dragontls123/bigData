{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":343,"status":"ok","timestamp":1669789740509,"user":{"displayName":"N S","userId":"15338044788712442045"},"user_tz":-540},"id":"OYLm0CtgxRN3","outputId":"32173fa9-73e5-46c4-d69c-ba5c00c2786a"},"outputs":[{"output_type":"stream","name":"stdout","text":["fatal: destination path 'yemoonsaBigdata' already exists and is not an empty directory.\n"]}],"source":["!git clone https://github.com/AnalyticsKnight/yemoonsaBigdata/\n","\n","# 출력을 원하실 경우 print() 함수 활용\n","# 예시) print(df.head())\n","\n","# getcwd(), chdir() 등 작업 폴더 설정 불필요\n","# 파일 경로 상 내부 드라이브 경로(C: 등) 접근 불가\n","\n","# 데이터 파일 읽기 예제\n","import pandas as pd\n","X_test = pd.read_csv(\"./yemoonsaBigdata/datasets/Part2/mpg_X_test.csv\")\n","X_train = pd.read_csv(\"./yemoonsaBigdata/datasets/Part2/mpg_X_train.csv\")\n","y_train = pd.read_csv(\"./yemoonsaBigdata/datasets/Part2/mpg_y_train.csv\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"fy4dfJJVxn_G"},"outputs":[],"source":["#1. 결측지 제거 : 결측지가 한 컬럼에 4개만 존재함으로 전부 drop\n","# 결측지가 많은 컬럼이 있으면 그 컬럼은 제외하고 분석 진행\n","X_train_drop=pd.concat([X_train,y_train],axis=1)\n","X_train_drop=X_train_drop.dropna(axis=0)\n","#X_train_drop.info()\n","#X_train_drop"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"WFuqa8RSYx6T"},"outputs":[],"source":["# 2. 사용할 컬럼 선택\n","col_del=['name']\n","col_num=['mpg', 'cylinders', 'displacement', 'horsepower', 'weight','acceleration', 'model_year']\n","col_cat=[]\n","col_Y=['isUSA']\n","X_test=X_test.iloc[:,1:]\n","X_train_temp=X_train_drop[col_num]\n","y_train_temp=X_train_drop[col_Y]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"b1XtFw1D4pn9"},"outputs":[],"source":["# 3. 테스트 데이터 분할\n","from sklearn.model_selection import train_test_split\n","\n","X_tr, X_val, y_tr, y_val = train_test_split(X_train_temp, y_train_temp, test_size=0.3)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Rg69I7Gq4LY7"},"outputs":[],"source":["# 4. 스케일링\n","from sklearn.preprocessing import MinMaxScaler\n","\n","scaler=MinMaxScaler()\n","scaler.fit(X_test)\n","X_test=scaler.transform(X_test)\n","X_tr=scaler.transform(X_tr)\n","X_val=scaler.transform(X_val)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":273,"status":"ok","timestamp":1669789830971,"user":{"displayName":"N S","userId":"15338044788712442045"},"user_tz":-540},"id":"OvJu-PDO9Not","outputId":"2fd040b2-b91a-488a-cc10-8c868d2b2801"},"outputs":[{"output_type":"stream","name":"stdout","text":["0.8795180722891566\n","0.9587662337662337\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:4: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().\n","  after removing the cwd from sys.path.\n"]}],"source":["# 5. RandomForestClassifier 모델링\n","from sklearn.ensemble import RandomForestClassifier\n","model=RandomForestClassifier(max_depth=10)\n","model.fit(X_tr, y_tr)\n","y_val_predict=model.predict(X_val)\n","y_val_predict_prob=model.predict_proba(X_val)\n","\n","# 6. 평가\n","from sklearn.metrics import roc_auc_score, accuracy_score\n","acscore=accuracy_score(y_val,y_val_predict)\n","print(acscore)\n","score=roc_auc_score(y_val,y_val_predict_prob[:,1])\n","print(score)\n","pred=y_val_predict_prob[:,1]"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":271,"status":"ok","timestamp":1669789845676,"user":{"displayName":"N S","userId":"15338044788712442045"},"user_tz":-540},"id":"O91k5FJm0f87","outputId":"33ce5bac-aa30-47d1-db15-33e87560618a"},"outputs":[{"output_type":"stream","name":"stdout","text":["0.9036144578313253\n","0.9753246753246753\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/sklearn/preprocessing/_label.py:98: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().\n","  y = column_or_1d(y, warn=True)\n","/usr/local/lib/python3.7/dist-packages/sklearn/preprocessing/_label.py:133: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().\n","  y = column_or_1d(y, warn=True)\n"]}],"source":["from lightgbm import LGBMClassifier\n","model=LGBMClassifier()\n","model.fit(X_tr, y_tr)\n","y_val_predict=model.predict(X_val)\n","y_val_predict_prob=model.predict_proba(X_val)\n","\n","\n","# 6. 평가\n","from sklearn.metrics import roc_auc_score\n","acscore=accuracy_score(y_val,y_val_predict)\n","print(acscore)\n","score=roc_auc_score(y_val,y_val_predict_prob[:,1])\n","print(score)\n","pred=y_val_predict_prob[:,1]"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":314,"status":"ok","timestamp":1669789849450,"user":{"displayName":"N S","userId":"15338044788712442045"},"user_tz":-540},"id":"vwDPW_700fy1","outputId":"7e0a11b8-4672-414f-ab8a-bf63948a7145"},"outputs":[{"output_type":"stream","name":"stdout","text":["0.927710843373494\n","0.974025974025974\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/sklearn/preprocessing/_label.py:98: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().\n","  y = column_or_1d(y, warn=True)\n","/usr/local/lib/python3.7/dist-packages/sklearn/preprocessing/_label.py:133: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().\n","  y = column_or_1d(y, warn=True)\n"]}],"source":["from xgboost import XGBClassifier\n","model=XGBClassifier()\n","model.fit(X_tr, y_tr)\n","y_val_predict=model.predict(X_val)\n","y_val_predict_prob=model.predict_proba(X_val)\n","\n","\n","# 6. 평가\n","from sklearn.metrics import roc_auc_score\n","acscore=accuracy_score(y_val,y_val_predict)\n","print(acscore)\n","score=roc_auc_score(y_val,y_val_predict_prob[:,1])\n","print(score)\n","pred=y_val_predict_prob[:,1]"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":777,"status":"ok","timestamp":1669789853337,"user":{"displayName":"N S","userId":"15338044788712442045"},"user_tz":-540},"id":"0lBgo7aiRZGh","outputId":"50c34810-b7ad-4b31-c2d8-1fab3847e65e"},"outputs":[{"output_type":"stream","name":"stdout","text":["0.9036144578313253\n","0.9753246753246753\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/sklearn/preprocessing/_label.py:98: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().\n","  y = column_or_1d(y, warn=True)\n","/usr/local/lib/python3.7/dist-packages/sklearn/preprocessing/_label.py:133: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().\n","  y = column_or_1d(y, warn=True)\n"]}],"source":["# 5. LGBMClassifier 모델링\n","from lightgbm import LGBMClassifier\n","model=LGBMClassifier()\n","model.fit(X_tr, y_tr)\n","y_val_predict=model.predict(X_val)\n","y_val_predict_prob=model.predict_proba(X_val)\n","# 6. 평가\n","from sklearn.metrics import roc_auc_score\n","acscore=accuracy_score(y_val,y_val_predict)\n","print(acscore)\n","score=roc_auc_score(y_val,y_val_predict_prob[:,1])\n","print(score)\n","pred=y_val_predict_prob[:,1]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"92OfSgJ8xi4m"},"outputs":[],"source":["# 답안 제출 참고\n","# 아래 코드 예측변수와 수험번호를 개인별로 변경하여 활용\n","pd.DataFrame({'gender': pred}).to_csv('003000000.csv', index=False)"]}],"metadata":{"colab":{"provenance":[],"authorship_tag":"ABX9TyNt+szb8/Nl1iL7OVpg+PUB"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}